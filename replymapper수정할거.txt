SELECT
    '5점 MAX' AS rating_range,
    COUNT(*) AS count,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM reply WHERE pno = ${pno}), 1) AS percentage
FROM
    reply
WHERE
    pno = ${pno} AND star = 5.0

UNION

SELECT
    '4점 GPA' AS rating_range,
    COUNT(*) AS count,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM reply WHERE pno = ${pno}), 1) AS percentage
FROM
    reply
WHERE
    pno = ${pno} AND star BETWEEN 4.0 AND 4.9

UNION

SELECT
    '3점 GPA' AS rating_range,
    COUNT(*) AS count,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM reply WHERE pno = ${pno}), 1) AS percentage
FROM
    reply
WHERE
    pno = ${pno} AND star BETWEEN 3.0 AND 3.9

UNION

SELECT
    '2점 GPA' AS rating_range,
    COUNT(*) AS count,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM reply WHERE pno = ${pno}), 1) AS percentage
FROM
    reply
WHERE
    pno = ${pno} AND star BETWEEN 2.0 AND 2.9

UNION

SELECT
    '1점 GPA' AS rating_range,
    COUNT(*) AS count,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM reply WHERE pno = ${pno}), 1) AS percentage
FROM
    reply
WHERE
    pno = ${pno} AND star BETWEEN 1.0 AND 1.9
ORDER BY
    rating_range;